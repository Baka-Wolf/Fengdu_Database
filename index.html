<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>/// é…†éƒ½æ•°æ®åº“_V2.0 ///</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%23ff7700%22/></svg>">

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=VT323&display=swap" rel="stylesheet">

<style>
    :root {
        --bg-color: #050505;
        --sidebar-bg: #0a0a0a;
        --text-main: #a8b0c0; 
        --accent: #ff7700;    
        --accent-dim: rgba(255, 119, 0, 0.15);
        --border: 1px solid #333;
        --danger: #ff3333;
    }

    * { box-sizing: border-box; }

    body {
        background-color: var(--bg-color);
        color: var(--text-main);
        margin: 0;
        height: 100vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        transition: filter 0.3s; /* å¹³æ»‘è¿‡æ¸¡æ•ˆæœ */
    }

    /* === è§†è§‰ç‰¹æ•ˆï¼šåŸºç¡€æ‰«æçº¿ === */
    .scanlines {
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.15) 50%);
        background-size: 100% 4px;
        pointer-events: none;
        z-index: 9998; 
        opacity: 0.6;
        transition: opacity 0.3s;
    }

    /* === è§†è§‰ç‰¹æ•ˆï¼šåŠ¨æ€å™ªç‚¹ (Noise) === */
    .noise-overlay {
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        pointer-events: none;
        z-index: 9997;
        opacity: 0.05; /* é»˜è®¤å¾ˆæ·¡ */
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='1'/%3E%3C/svg%3E");
        transition: opacity 0.3s;
    }

    /* === è§†è§‰ç‰¹æ•ˆï¼šæ‘©å°”çº¹ (MoirÃ©) === */
    .moire-overlay {
        position: fixed;
        top: -50%; left: -50%; width: 200%; height: 200%;
        pointer-events: none;
        z-index: 9999;
        background: radial-gradient(circle, transparent 20%, #000 120%),
                    repeating-radial-gradient(#000 0, #000 2px, transparent 3px, transparent 6px);
        opacity: 0; /* é»˜è®¤éšè— */
        transform: rotate(0deg);
        transition: opacity 1s ease;
    }

    /* === BOOST æ¿€æ´»çŠ¶æ€ === */
    body.boost-active .noise-overlay {
        opacity: 0.4; /* å™ªç‚¹å¤§å¹…å¢å¼º */
        animation: noiseFlicker 0.2s infinite;
    }

    body.boost-active .scanlines {
        opacity: 0.9;
        background-size: 100% 2px; /* æ‰«æçº¿å˜å¯† */
    }
    
    body.boost-active .moire-overlay {
        opacity: 0.15; /* æ‘©å°”çº¹æ˜¾ç° */
        animation: moireRotate 60s linear infinite;
    }

    body.boost-active {
        /* è‰²å·®åç§» (RGB Split) + å¯¹æ¯”åº¦å¢å¼º */
        text-shadow: 2px 0 var(--danger), -2px 0 #00ffff;
        filter: contrast(1.3) brightness(0.8);
    }

    @keyframes noiseFlicker {
        0% { transform: translate(0,0); }
        10% { transform: translate(-1%, -1%); }
        20% { transform: translate(1%, 1%); }
        30% { transform: translate(-2%, 2%); }
        40% { transform: translate(2%, -2%); }
        100% { transform: translate(0,0); }
    }

    @keyframes moireRotate {
        0% { transform: rotate(0deg) scale(1); }
        50% { transform: rotate(180deg) scale(1.1); }
        100% { transform: rotate(360deg) scale(1); }
    }


    /* === æ¨¡æ‹Ÿç™»å½•å±‚ === */
    #login-overlay {
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        background-color: #000;
        z-index: 5000; 
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        font-family: 'JetBrains Mono', monospace;
        transition: transform 0.8s cubic-bezier(0.7, 0, 0.3, 1);
    }

    .login-box {
        border: 2px solid var(--accent);
        padding: 40px;
        width: 350px;
        background: rgba(10, 10, 10, 0.9);
        box-shadow: 0 0 20px var(--accent-dim);
        text-align: center;
        opacity: 0; 
        animation: fadeInBox 1s ease-out forwards;
    }

    @keyframes fadeInBox {
        0% { opacity: 0; transform: scale(0.95); }
        100% { opacity: 1; transform: scale(1); }
    }

    .user-avatar {
        width: 80px; height: 80px; background: #222;
        border: 1px solid #444; margin: 0 auto 20px auto;
        display: flex; align-items: center; justify-content: center;
        font-size: 2rem; color: #555;
    }

    .user-name {
        margin-bottom: 20px; font-size: 0.9rem;
        color: var(--accent); letter-spacing: 2px;
    }

    .password-display {
        background: #111; border: 1px solid #333; height: 35px;
        width: 100%; margin-bottom: 20px; display: flex;
        align-items: center; padding: 0 10px; color: var(--accent);
        font-family: 'VT323', monospace; font-size: 1.5rem; letter-spacing: 3px;
    }

    .login-status {
        font-size: 0.75rem; color: #666; height: 20px;
    }

    .slide-up { transform: translateY(-100%); }

    /* === é¡¶æ  & ä¸»ä½“ === */
    header {
        height: 50px; border-bottom: var(--border); display: flex;
        align-items: center; padding: 0 20px; justify-content: space-between;
        background: #000; font-family: 'JetBrains Mono', monospace; z-index: 1000;
    }

    .brand { color: var(--accent); font-weight: bold; letter-spacing: 2px; text-shadow: 0 0 8px var(--accent-dim); }

    .header-controls button {
        background: transparent; border: 1px solid #444; color: #888;
        padding: 5px 12px; cursor: pointer; font-family: 'JetBrains Mono', monospace;
        font-size: 0.75rem; margin-left: 8px; transition: 0.3s;
    }

    .header-controls button:hover { border-color: var(--accent); color: var(--accent); }
    
    .header-controls button.active {
        background: var(--accent-dim); border-color: var(--accent);
        color: var(--accent); box-shadow: 0 0 10px var(--accent-dim);
    }
    
    /* å¢å¼ºæ¨¡å¼æŒ‰é’®æ ·å¼ */
    button#boost-btn.active {
        background: #f00;
        color: #000;
        border-color: #f00;
        box-shadow: 0 0 15px #f00;
        animation: textFlicker 0.1s infinite;
    }

    .workspace { display: flex; flex: 1; overflow: hidden; }

    /* ä¾§è¾¹æ  */
    .sidebar {
        width: 260px; background: var(--sidebar-bg); border-right: var(--border);
        display: flex; flex-direction: column; font-family: 'JetBrains Mono', monospace; 
    }
    
    .sidebar-search {
        padding: 10px 15px;
        border-bottom: var(--border);
    }

    .search-input {
        width: 100%; padding: 8px; background: #111;
        border: 1px solid #333; color: var(--text-main);
        font-family: 'JetBrains Mono', monospace; font-size: 0.8rem;
        outline: none;
    }
    .search-input:focus { border-color: var(--accent); }

    .sidebar-header {
        padding: 15px; border-bottom: var(--border); display: flex;
        justify-content: space-between; align-items: center; font-size: 0.8rem;
        color: #666;
    }
    
    .add-btn { display: none; } 

    .doc-list {
        list-style: none; padding: 0; margin: 0; overflow-y: auto;
    }

    .doc-item {
        padding: 12px 15px; border-bottom: 1px solid #1a1a1a;
        cursor: grab; font-size: 0.85rem; opacity: 0.7; transition: 0.2s;
    }

    .doc-item:hover { background: #111; opacity: 1; }
    .doc-item.active {
        background: rgba(255,255,255,0.05); border-left: 3px solid var(--accent);
        color: var(--accent); opacity: 1;
    }
    
    .doc-item.active-drop { border-top: 2px solid #fff; } 
    .doc-item.dragging { opacity: 0.4; } 


    /* === ä¸»é¢æ¿ === */
    .main-panel { flex: 1; display: flex; flex-direction: column; background: var(--bg-color); }

    .toolbar {
        padding: 10px 30px; border-bottom: var(--border); display: flex;
        justify-content: space-between; background: #080808;
    }

    .doc-title-input {
        background: transparent; border: none; color: #fff;
        font-family: 'JetBrains Mono', monospace; font-size: 1.1rem;
        width: 100%; outline: none; 
        cursor: default;
    }

    .content-area { flex: 1; position: relative; overflow: hidden; }

    /* === é¢„è§ˆæ¨¡å¼ & åŠ¨ç”»å¢å¼º === */
    #preview-view {
        width: 100%; height: 100%; padding: 40px 60px;
        overflow-y: auto; font-family: 'VT323','JetBrains Mono', sans-serif; 
        font-size: 1.4rem; line-height: 1.5; color: var(--text-main); 
        text-shadow: 
            0 0 1px var(--text-main), 
            1px 0 3px var(--accent),  
            -1px 0 5px var(--accent-dim); 
        filter: blur(0.1px); 
    }

    @keyframes lineReveal {
        0% { 
            opacity: 0; 
            transform: translateY(3px); 
            filter: blur(0.5px); 
        }
        100% { 
            opacity: 1; 
            transform: translateY(0); 
            filter: blur(0.1px);
        }
    }

    .reveal-anim {
        animation: lineReveal 0.2s cubic-bezier(0.11, 0, 0.5, 0) forwards;
        opacity: 0; 
    }

    #preview-view h1, #preview-view h2, #preview-view h3 {
        color: var(--accent); text-transform: uppercase; letter-spacing: 1px;
    }
    #preview-view h1 { border-bottom: 2px dashed #444; padding-bottom: 10px; }
    #preview-view blockquote {
        border-left: 4px solid var(--accent); background: rgba(20, 20, 20, 0.8);
        color: #888; font-style: normal;
    }
    #preview-view code {
        background: #222; color: var(--accent); padding: 2px 5px;
        font-family: 'VT323', monospace; border: 1px solid #444;
    }
    
    /* é“¾æ¥æ ·å¼ */
    #preview-view a { color: var(--accent); text-decoration: none; border-bottom: 1px dashed var(--accent); }
    #preview-view a:hover { background: var(--accent); color: #000; }

    .hidden { display: none !important; }

    .toggle { display:none; }
    .text1, .text2 { cursor:pointer; }
    .toggle ~ .text2 { display:none; }
    .toggle:checked ~ .text1 { display:none; }
    .toggle:checked ~ .text2 { display:inline; }

</style>
</head>
<body>

<div class="scanlines"></div>
<div class="noise-overlay"></div> <div class="moire-overlay"></div> <div id="login-overlay">
    <div class="login-box">
        <div class="user-avatar">?</div> 
        <div class="user-name">USER: â– â– â– â– â– â– â– â– </div>
        <div class="password-display" id="pwd-display"></div>
        <div class="login-status" id="login-status">WAITING FOR INPUT...</div>
    </div>
</div>

<audio id="bgm" loop>
    <source src="Neon Circuitry (mp3cut.net).mp3" type="audio/mpeg">
</audio>

<audio id="sfx">
    <source src="click.mp3" type="audio/mpeg">
</audio>

<header>
    <div class="brand">/// Fengdu_Database</div>
    <div class="header-controls">
        <span id="status-msg" style="color:#444; margin-right:15px; font-size:0.7rem;">SYSTEM_IDLE</span>
        
        <button id="audio-btn" onclick="playSFX(); toggleAudio()">[ ğŸ”‡ MUTE ]</button>
        
        <button onclick="playSFX(); window.open('https://github.com/Baka-Wolf/Fengdu_Database', '_blank')">â†— GITHUB</button>
        
        <button id="boost-btn" onclick="playSFX(); toggleBoost()">[ âš¡ BOOST ]</button>
    </div>
</header>

<div class="workspace">
    <aside class="sidebar">
        <div class="sidebar-search">
            <input type="text" id="search-input" class="search-input" placeholder="SEARCH_DATABASE..." oninput="searchDocs()">
        </div>
        
        <div class="sidebar-header">
            <span>DATABASE_INDEX</span>
            <button class="add-btn">+</button> 
        </div>
        <ul class="doc-list" id="doc-list"></ul>
    </aside>

    <main class="main-panel">
        <div class="toolbar">
            <input type="text" id="doc-title" class="doc-title-input" placeholder="UNTITLED_FILE" readonly>
            <div></div>
        </div>

        <div class="content-area">
            <div id="preview-view" class="markdown-body"></div>
        </div>
    </main>
</div>

<script>
    // --- éŸ³é¢‘å‡½æ•° ---
    const bgm = document.getElementById('bgm');
    const sfx = document.getElementById('sfx');
    bgm.volume = 0.4; 
    sfx.volume = 0.6; 

    function playSFX() {
        sfx.currentTime = 0;
        sfx.play().catch(e => console.log("SFX play blocked"));
    }

    function toggleAudio() {
        const btn = document.getElementById('audio-btn');
        if (bgm.paused) {
            bgm.play().then(() => {
                btn.innerHTML = "[ ğŸ”Š PLAYING ]";
                btn.classList.add('active');
            }).catch(e => {
                console.log("Audio play failed:", e);
            });
        } else {
            bgm.pause();
            btn.innerHTML = "[ ğŸ”‡ MUTE ]";
            btn.classList.remove('active');
        }
    }

    // --- è§†è§‰å¢å¼º (Boost) é€»è¾‘ ---
    let isBoosted = false;
    function toggleBoost() {
        isBoosted = !isBoosted;
        const btn = document.getElementById('boost-btn');
        const body = document.body;
        
        if (isBoosted) {
            body.classList.add('boost-active');
            btn.classList.add('active');
            btn.innerHTML = "[ âš¡ ACTIVE ]";
            // æ’­æ”¾ä¸€ä¸ªéŸ³æ•ˆæ›´åˆé€‚ï¼Œè¿™é‡Œå¤ç”¨ç‚¹å‡»éŸ³æ•ˆ
        } else {
            body.classList.remove('boost-active');
            btn.classList.remove('active');
            btn.innerHTML = "[ âš¡ BOOST ]";
        }
    }

    // --- å¯åŠ¨åºåˆ—åŠ¨ç”» ---
    function runBootSequence() {
        const overlay = document.getElementById('login-overlay');
        const pwdDisplay = document.getElementById('pwd-display');
        const status = document.getElementById('login-status');
        
        const passwordLength = 8;
        let currentLen = 0;

        setTimeout(() => {
            status.innerText = "AUTHENTICATING...";
            status.style.color = "var(--accent)";

            const typeInterval = setInterval(() => {
                currentLen++;
                let dots = "";
                for(let i=0; i<currentLen; i++) dots += "â—";
                pwdDisplay.innerText = dots;

                if (currentLen >= passwordLength) {
                    clearInterval(typeInterval);
                    finishLogin();
                }
            }, 100); 

        }, 800);

        function finishLogin() {
            setTimeout(() => {
                status.innerText = "ACCESS GRANTED";
                status.style.color = "#0f0"; 
                
                setTimeout(() => {
                    overlay.classList.add('slide-up');
                    setTimeout(() => { overlay.style.display = 'none'; }, 800);
                    fetchDataFile();
                }, 600);
            }, 300);
        }
    }

    // --- æ•°æ®é€»è¾‘ ---
    let docs = [];
    let currentDocId = null;
    let draggedDocId = null; 
    
    const loadingDoc = [{ 
        id: 'sys_loading', 
        title: 'INITIALIZING...', 
        content: '# SYSTEM STARTUP\n\nAttempting to establish connection with local data archive...\n\n> Please wait.' 
    }];

    window.onload = function() {
        docs = loadingDoc;
        renderList(); 
        selectDoc(docs[0].id);
        runBootSequence();
    };

    function fetchDataFile() {
        showStatus('FETCHING DATA...');
        fetch('archive_dump.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error("HTTP error " + response.status);
                }
                return response.json();
            })
            .then(data => {
                if (Array.isArray(data) && data.length > 0) {
                    docs = data;
                    renderList();
                    selectDoc(docs[0].id);
                    showStatus('ARCHIVE LOADED');
                } else {
                    throw new Error("Empty or invalid JSON");
                }
            })
            .catch(err => {
                console.error("Data load failed:", err);
                showStatus('CONNECTION FAILED');
                docs = [{ 
                    id: 'error_00', 
                    title: 'CONNECTION_ERROR', 
                    content: `# FATAL ERROR\n\nCould not load 'archive_dump.json'.\n\n### DIAGNOSTICS\n1. Ensure 'archive_dump.json' exists in the same folder.\n2. If viewing locally (file://), browser security may block file reading. Use a local server (like Live Server) or deploy to GitHub Pages.\n\nError details: ${err.message}` 
                }];
                renderList();
                selectDoc(docs[0].id);
            });
    }

    function renderList(listToRender = docs) {
        const list = document.getElementById('doc-list');
        list.innerHTML = '';
        
        listToRender.forEach(doc => {
            const li = document.createElement('li');
            li.className = `doc-item ${doc.id === currentDocId ? 'active' : ''}`;
            li.textContent = doc.title || 'UNNAMED_DATA';
            li.onclick = () => { playSFX(); selectDoc(doc.id); };
            
            li.setAttribute('draggable', 'true');
            li.setAttribute('data-id', doc.id);
            li.addEventListener('dragstart', handleDragStart);
            li.addEventListener('dragover', handleDragOver);
            li.addEventListener('drop', handleDrop);
            li.addEventListener('dragleave', handleDragLeave);
            li.addEventListener('dragend', handleDragEnd);

            list.appendChild(li);
        });
    }

    function handleDragStart(e) { draggedDocId = this.getAttribute('data-id'); e.dataTransfer.effectAllowed = 'move'; this.classList.add('dragging'); }
    function handleDragOver(e) { e.preventDefault(); e.dataTransfer.dropEffect = 'move'; document.querySelectorAll('.doc-item').forEach(item => item.classList.remove('active-drop')); this.classList.add('active-drop'); }
    function handleDragLeave() { this.classList.remove('active-drop'); }
    function handleDragEnd() { document.querySelectorAll('.doc-item').forEach(item => { item.classList.remove('active-drop', 'dragging'); }); }
    function handleDrop(e) {
        e.preventDefault(); playSFX(); 
        const targetDocId = this.getAttribute('data-id');
        if (draggedDocId === targetDocId) return;
        const draggedIndex = docs.findIndex(d => d.id === draggedDocId);
        const targetIndex = docs.findIndex(d => d.id === targetDocId);
        if (draggedIndex > -1 && targetIndex > -1) {
            const [movedDoc] = docs.splice(draggedIndex, 1);
            docs.splice(targetIndex, 0, movedDoc);
            renderList();
        }
        this.classList.remove('active-drop'); draggedDocId = null;
    }

    function searchDocs() {
        const query = document.getElementById('search-input').value.toLowerCase();
        const list = document.getElementById('doc-list');
        list.innerHTML = '';
        const filteredDocs = docs.filter(doc => doc.title.toLowerCase().includes(query) || doc.content.toLowerCase().includes(query));
        renderList(filteredDocs);
    }

    function selectDoc(id) {
        currentDocId = id;
        const doc = docs.find(d => d.id === id);
        if (doc) {
            document.getElementById('doc-title').value = doc.title;
            renderMarkdown(doc.content);
        }
        renderList();
    }

    function renderMarkdown(content) {
        const preview = document.getElementById('preview-view');
        preview.innerHTML = marked.parse(content);
        const elements = preview.children;
        Array.from(elements).forEach((el, index) => {
            el.style.opacity = '0'; 
            const delay = index * 0.05; 
            el.style.animationDelay = `${delay}s`;
            el.classList.add('reveal-anim');
        });
    }

    function showStatus(msg) {
        const el = document.getElementById('status-msg');
        el.textContent = msg;
        setTimeout(() => { el.textContent = 'SYSTEM_IDLE'; }, 2000);
    }
</script>
</body>
</html>

